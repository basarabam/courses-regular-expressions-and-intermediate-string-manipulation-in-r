---
title: Insert title here
key: b830b2075b68dfb75dfcbf2e59156135

---
## 2.4. Replacing strings using regular expressions

```yaml
type: "TitleSlide"
key: "9d82d87138"
```

`@lower_third`

name: Milos Basaraba
title: Data Scientist


`@script`
Welcome back!
In the last section of this chapter it's time to learn and practice how to apply string replacement to a real world problems, with Regular Expressions.
String replacement might save you a lot of time, especially in combination with regular expressions.


---
## Stringr

```yaml
type: "FullSlide"
key: "53619ffa4f"
code_zoom: 93
```

`@part1`
```str_replace()``` and ```str_replace_all()``` {{0}}

``` 
str <- c("football", "basketball", "tennis", “voleyball“)
pattern = "[aeiou]"
replace = "_"
str_replace(x, "[aeiou]", "_")
```{{1}}

```
[1] "f_otball"   "b_sketball" "t_nnis"     "v_leyball"
```{{2}}

``` 
str_replace_all(str, "[aeiou]", "_")
``` {{3}}

```[1] "f__tb_ll"   "b_sk_tb_ll" "t_nn_s"     "v_l_yb_ll"
```{{4}}


`@script`
As in the previous lessons, first we are going to talk about Stringr functions for replacing strings. 
The most usual tasks with strings could be done with stringr package, it has very simply syntax and it is easy to learn
Stringr package has two functions for replacing strings. 
str_replace()
str_replace_all()
Both functions takes three arguments
Input vector - Either a character vector, or something coercible to character vector.
Pattern - Pattern to look for. Pattern can be a string or regular expression.
Replacement - A character vector of replacements. Vector of replacements should be either length one, or the same length as string or pattern, or strange behavior may occur.
Replacement argument may take named vector or function for performing multiple replacements.
Imagine the situation, that you get the task to remove all vowels from the name of different sports. It is necessary for some letter guessing  game in the quiz, your company produces. You can do it by hand, but in that case, you are going to loose whole day on that task. If you have the list of sports, that is not a problem at all for stringr. You are going to do the task for 2 minutes! 
You are having the str character vector with the names of some sports, for testing purpose
In the testing phase, first you are going to test the str_replace function, with regular expression for vowels, and replace vowels with underscores.


---
## Negation

```yaml
type: "FullSlide"
key: "35c11a48ab"
code_zoom: 87
```

`@part1`
- **Negation**  ```[^...]```{{1}}
- Leading ```^``` negates the list ```[...]```{{2}}
- Don't mix up with start of the line caret ```^```{{3}}
- Totaly different meaning in the list ```[^...]```{{4}}
- Only when it is immediately after the class's opening bracket {{5}}
```
> str_replace(str, "[^aeiou]", "_")
[1] "_ootball"   "_asketball" "_ennis"     "_oleyball"{{6}}
```

```
> str_replace_all(str, "[^aeiou]", "_")
[1] "_oo__a__"   "_a__e__a__" "_e__i_"     "_o_e__a__"
```{{7}}


`@script`



---
## Multiple replacements

```yaml
type: "FullSlide"
key: "fe76ca9ba0"
code_zoom: 60
```

`@part1`
With ```str_replace_all()``` you can perform multiple replacements by **supplying a named vector**{{1}}
```
str <- c("4 friends", "2 bars", "30 beers", "4 hangovers")
str_replace_all(str, c("4" = "four", "2" = "two", "30" = "thirty", "4" = "hangovers"))
```{{2}}

```
[1] "four friends"   "two bars"       "thirty beers"   "four hangovers"
```{{3}}


`@script`



---
## Inserting components of the match

```yaml
type: "FullSlide"
key: "4de64cc29d"
code_zoom: 85
```

`@part1`
Instead of replacing with a fixed string, you can use **backreferences** to insert components of the match {{1}}
```
sentences <- c("The canoe birch slid on the smooth planks." 
, "Glue sheet the to the dark blue background."
, "It's to easy tell the depth of a well.")

str_replace(sentences, "([^ ]+) ([^ ]+) ([^ ]+)", "\\1 \\3 \\2")
```{{2}}

```
[1] "The birch canoe slid on the smooth planks."
[2] "Glue the sheet to the dark blue background."
[3] "It's easy to tell the depth of a well."
```{{3}}


`@script`
In the following code example, the order of the second and third words is flipped


---
## Matching with functions

```yaml
type: "FullSlide"
key: "75ca73b041"
code_zoom: 75
```

`@part1`
It is possible to use replacement argument as the function
```
str_replace_all(sentences, "[aeiou]", toupper)
```

```
[1] "ThE cAnOE bIrch slId On thE smOOth plAnks."
[2] "GlUE shEEt thE tO thE dArk blUE bAckgrOUnd."
[3] "It's tO EAsy tEll thE dEpth Of A wEll."
```
or to change pattern to NA values
```
str_replace_all(sentences, "b", NA_character_)
```

```
[1] NA                                       
[2] NA                                       
[3] "It's to easy tell the depth of a well."
```


`@script`



---
## Stringi replacing

```yaml
type: "FullSlide"
key: "c2fab64bf2"
code_zoom: 85
```

`@part1`
- These functions replace, with the given replacement string, every/first/last substring of the input that matches the specified pattern.
- Many different options for fine tuning in replacement process

```
stri_replace_*_*
```

```
> stri_replace_all_charclass("aaaa", "[a]", "b", merge=FALSE)
[1] "bbbb"
```

```
> stri_replace_all_charclass("aaaa", "[a]", "b", merge = TRUE)
[1] "b"
```


`@script`



---
## Stringi replacing with or without vectorizing

```yaml
type: "FullSlide"
key: "b632590873"
code_zoom: 70
```

`@part1`
- single logical value; should each occurrence of a pattern in every string be replaced by a corresponding replacement string?;
- ```stri_replace_all_*``` only!

```
> stri_replace_all_fixed("The quick brown fox jumped over the lazy dog.",
c("quick", "brown", "fox"), c("slow",  "black", "bear"), vectorize_all=TRUE)
[1] "The slow brown fox jumped over the lazy dog."
"The quick black fox jumped over the lazy dog." 
[3] "The quick brown bear jumped over the lazy dog."
```

```
> stri_replace_all_fixed("The quick brown fox jumped over the lazy dog.",
c("quick", "brown", "fox"), c("slow",  "black", "bear"), vectorize_all=FALSE)
[1] "The slow black bear jumped over the lazy dog."
```
- many different functions with a lot of options, for replacing strings


`@script`



---
## Let's practice!

```yaml
type: "FinalSlide"
key: "a7ec146d9b"
```

`@script`
See you in the next chapter after you successfully do the practical exercises. Happy stringing

